[unix_http_server]
file=/tmp/supervisor.sock
chmod=0700

[supervisord]
logfile=/app/logs/supervisord.log
logfile_maxbytes=50MB
logfile_backups=10
loglevel=info
pidfile=/tmp/supervisord.pid
nodaemon=false
minfds=1024
minprocs=200

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

[program:telegram-bot]
command=/app/.venv/bin/python main.py
directory=/app
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/telegram-bot.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/app/logs/telegram-bot-error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=PYTHONPATH="/app",ENVIRONMENT="production",PYTHONUNBUFFERED="1",PATH="/app/.venv/bin:%(ENV_PATH)s"
startsecs=10
startretries=3
stopwaitsecs=30
killasgroup=true
stopasgroup=true

[program:admin-panel]
command=/app/.venv/bin/python run_admin.py
directory=/app
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/admin-panel.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/app/logs/admin-panel-error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=PYTHONPATH="/app",ENVIRONMENT="production",PYTHONUNBUFFERED="1",ADMIN_HOST="0.0.0.0",ADMIN_PORT="8080",PATH="/app/.venv/bin:%(ENV_PATH)s"
startsecs=15
startretries=3
stopwaitsecs=30
killasgroup=true
stopasgroup=true

[program:migration-watcher]
command=/app/.venv/bin/python production_migration_watcher.py
directory=/app
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/migration-watcher.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/app/logs/migration-watcher-error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=PYTHONPATH="/app",ENVIRONMENT="production",PYTHONUNBUFFERED="1",PATH="/app/.venv/bin:%(ENV_PATH)s"
startsecs=5
startretries=3
stopwaitsecs=10
killasgroup=true
stopasgroup=true

[program:data-sync-service]
command=/app/.venv/bin/python production_data_sync.py
directory=/app
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/data-sync.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/app/logs/data-sync-error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=PYTHONPATH="/app",ENVIRONMENT="production",PYTHONUNBUFFERED="1",PATH="/app/.venv/bin:%(ENV_PATH)s"
startsecs=5
startretries=3
stopwaitsecs=10
killasgroup=true
stopasgroup=true

[program:health-monitor]
command=/app/.venv/bin/python production_health_monitor.py
directory=/app
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/health-monitor.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/app/logs/health-monitor-error.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
environment=PYTHONPATH="/app",ENVIRONMENT="production",PYTHONUNBUFFERED="1",PATH="/app/.venv/bin:%(ENV_PATH)s"
startsecs=5
startretries=3
stopwaitsecs=10
killasgroup=true
stopasgroup=true

[group:findertool-services]
programs=telegram-bot,admin-panel,migration-watcher,data-sync-service,health-monitor
priority=999
